# Configuration for ImageNet100 dataset
# Dataset from Kaggle: https://www.kaggle.com/datasets/ambityga/imagenet100
# 100 classes, 130k train images, 5k val images

data:
  dataset: imagenet100
  data_path: ./dataset/imagenet100
  batch_size: 64
  num_workers: 4
  pin_memory: true
  train_split: 0.85
  val_split: 0.15
  seed: 42

augmentation:
  num_local_views: 6
  global_crop_size: 224
  local_crop_size: 96
  global_crop_scale_min: 0.4
  global_crop_scale_max: 1.0
  local_crop_scale_min: 0.05
  local_crop_scale_max: 0.4
  color_jitter_prob: 0.8
  color_jitter_brightness: 0.4
  color_jitter_contrast: 0.4
  color_jitter_saturation: 0.2
  color_jitter_hue: 0.1
  horizontal_flip_prob: 0.5
  grayscale_prob: 0.2
  gaussian_blur_sigma_min: 0.1
  gaussian_blur_sigma_max: 2.0
  solarization_prob: 0.2
  solarization_threshold: 128
  normalize_mean: [0.485, 0.456, 0.406]  # ImageNet normalization
  normalize_std: [0.229, 0.224, 0.225]

model:
  backbone: resnet34
  backbone_pretrained: false
  projection_hidden_dim: 2048
  projection_bottleneck_dim: 256
  projection_output_dim: 4096
  use_weight_norm: false

loss:
  student_temp: 0.1
  teacher_temp: 0.04
  center_momentum: 0.9

optimizer:
  optimizer: adamw
  lr: 0.001
  weight_decay: 0.04
  betas: [0.9, 0.999]
  eps: 1.0e-08

scheduler:
  scheduler: cosine
  warmup_epochs: 10
  min_lr: 1.0e-06

training:
  num_epochs: 300
  teacher_momentum: 0.996
  teacher_momentum_schedule: true
  teacher_momentum_final: 1.0
  gradient_clip: 3.0
  gradient_accumulation_steps: 8
  seed: 42
  device: cuda

checkpoint:
  checkpoint_dir: ./checkpoints/imagenet100/resnet
  save_every_n_epochs: 10
  save_best: true
  resume_from: null

logging:
  log_dir: ./logs/imagenet100/resnet
  log_every_n_iters: 50
  log_verbosity: debug
